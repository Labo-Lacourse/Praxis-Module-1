
data alcoholpp;
input
ID	AGE	COA	MALE	AGE_14	ALCUSE	PEER	CPEER	CCOA;
cards;
1	14	1	0	0	1.73205077648162	1.26491105556488	0.24691105556488	0.549
1	15	1	0	1	2	1.26491105556488	0.24691105556488	0.549
1	16	1	0	2	2	1.26491105556488	0.24691105556488	0.549
2	14	1	1	0	0	0.894427180290222	-0.123572819709778	0.549
2	15	1	1	1	0	0.894427180290222	-0.123572819709778	0.549
2	16	1	1	2	1	0.894427180290222	-0.123572819709778	0.549
3	14	1	1	0	1	0.894427180290222	-0.123572819709778	0.549
3	15	1	1	1	2	0.894427180290222	-0.123572819709778	0.549
3	16	1	1	2	3.31662487983703	0.894427180290222	-0.123572819709778	0.549
4	14	1	1	0	0	1.78885436058044	0.770854360580444	0.549
4	15	1	1	1	2	1.78885436058044	0.770854360580444	0.549
4	16	1	1	2	1.73205077648162	1.78885436058044	0.770854360580444	0.549
5	14	1	0	0	0	0.894427180290222	-0.123572819709778	0.549
5	15	1	0	1	0	0.894427180290222	-0.123572819709778	0.549
5	16	1	0	2	0	0.894427180290222	-0.123572819709778	0.549
6	14	1	1	0	3	1.54919338226318	0.531193382263184	0.549
6	15	1	1	1	3	1.54919338226318	0.531193382263184	0.549
6	16	1	1	2	3.16227769851684	1.54919338226318	0.531193382263184	0.549
7	14	1	0	0	1.73205077648162	1.54919338226318	0.531193382263184	0.549
7	15	1	0	1	2.44948983192443	1.54919338226318	0.531193382263184	0.549
7	16	1	0	2	1	1.54919338226318	0.531193382263184	0.549
8	14	1	1	0	0	0	-1.018	0.549
8	15	1	1	1	0	0	-1.018	0.549
8	16	1	1	2	0	0	-1.018	0.549
9	14	1	1	0	0	0	-1.018	0.549
9	15	1	1	1	1	0	-1.018	0.549
9	16	1	1	2	3.46410155296325	0	-1.018	0.549
10	14	1	0	0	1	2	0.982	0.549
10	15	1	0	1	1	2	0.982	0.549
10	16	1	0	2	1	2	0.982	0.549
11	14	1	1	0	0	0	-1.018	0.549
11	15	1	1	1	0	0	-1.018	0.549
11	16	1	1	2	3.16227769851684	0	-1.018	0.549
12	14	1	1	0	1	1.26491105556488	0.24691105556488	0.549
12	15	1	1	1	0	1.26491105556488	0.24691105556488	0.549
12	16	1	1	2	1.73205077648162	1.26491105556488	0.24691105556488	0.549
13	14	1	1	0	0	0	-1.018	0.549
13	15	1	1	1	0	0	-1.018	0.549
13	16	1	1	2	2	0	-1.018	0.549
14	14	1	0	0	2.82842707633972	2	0.982	0.549
14	15	1	0	1	3.60555124282836	2	0.982	0.549
14	16	1	0	2	2.82842707633972	2	0.982	0.549
15	14	1	0	0	1.73205077648162	2	0.982	0.549
15	15	1	0	1	2.2360680103302	2	0.982	0.549
15	16	1	0	2	2.44948983192443	2	0.982	0.549
16	14	1	0	0	1	1.26491105556488	0.24691105556488	0.549
16	15	1	0	1	1.41421353816986	1.26491105556488	0.24691105556488	0.549
16	16	1	0	2	1.41421353816986	1.26491105556488	0.24691105556488	0.549
17	14	1	0	0	0	0.894427180290222	-0.123572819709778	0.549
17	15	1	0	1	1	0.894427180290222	-0.123572819709778	0.549
17	16	1	0	2	0	0.894427180290222	-0.123572819709778	0.549
18	14	1	1	0	2	1.78885436058044	0.770854360580444	0.549
18	15	1	1	1	1.73205077648162	1.78885436058044	0.770854360580444	0.549
18	16	1	1	2	1	1.78885436058044	0.770854360580444	0.549
19	14	1	0	0	0	0	-1.018	0.549
19	15	1	0	1	0	0	-1.018	0.549
19	16	1	0	2	0	0	-1.018	0.549
20	14	1	0	0	3.31662487983703	2.52982211112976	1.51182211112976	0.549
20	15	1	0	1	3.60555124282836	2.52982211112976	1.51182211112976	0.549
20	16	1	0	2	1	2.52982211112976	1.51182211112976	0.549
21	14	1	1	0	1	1.78885436058044	0.770854360580444	0.549
21	15	1	1	1	1.73205077648162	1.78885436058044	0.770854360580444	0.549
21	16	1	1	2	1.73205077648162	1.78885436058044	0.770854360580444	0.549
22	14	1	1	0	2.82842707633972	2	0.982	0.549
22	15	1	1	1	2.82842707633972	2	0.982	0.549
22	16	1	1	2	1	2	0.982	0.549
23	14	1	1	0	1	0	-1.018	0.549
23	15	1	1	1	1	0	-1.018	0.549
23	16	1	1	2	1.73205077648162	0	-1.018	0.549
24	14	1	0	0	0	0	-1.018	0.549
24	15	1	0	1	1	0	-1.018	0.549
24	16	1	0	2	0	0	-1.018	0.549
25	14	1	1	0	3	2.19089031219482	1.17289031219482	0.549
25	15	1	1	1	1	2.19089031219482	1.17289031219482	0.549
25	16	1	1	2	2.64575123786926	2.19089031219482	1.17289031219482	0.549
26	14	1	0	0	0	1.54919338226318	0.531193382263184	0.549
26	15	1	0	1	1	1.54919338226318	0.531193382263184	0.549
26	16	1	0	2	1.41421353816986	1.54919338226318	0.531193382263184	0.549
27	14	1	0	0	3	1.78885436058044	0.770854360580444	0.549
27	15	1	0	1	0	1.78885436058044	0.770854360580444	0.549
27	16	1	0	2	1.73205077648162	1.78885436058044	0.770854360580444	0.549
28	14	1	0	0	0	0.894427180290222	-0.123572819709778	0.549
28	15	1	0	1	0	0.894427180290222	-0.123572819709778	0.549
28	16	1	0	2	0	0.894427180290222	-0.123572819709778	0.549
29	14	1	1	0	0	0.894427180290222	-0.123572819709778	0.549
29	15	1	1	1	0	0.894427180290222	-0.123572819709778	0.549
29	16	1	1	2	1	0.894427180290222	-0.123572819709778	0.549
30	14	1	0	0	1	1.26491105556488	0.24691105556488	0.549
30	15	1	0	1	2	1.26491105556488	0.24691105556488	0.549
30	16	1	0	2	1.73205077648162	1.26491105556488	0.24691105556488	0.549
31	14	1	1	0	1.73205077648162	1.78885436058044	0.770854360580444	0.549
31	15	1	1	1	3.46410155296325	1.78885436058044	0.770854360580444	0.549
31	16	1	1	2	2.82842707633972	1.78885436058044	0.770854360580444	0.549
32	14	1	1	0	1.73205077648162	0	-1.018	0.549
32	15	1	1	1	1.41421353816986	0	-1.018	0.549
32	16	1	1	2	1	0	-1.018	0.549
33	14	1	0	0	0	0.894427180290222	-0.123572819709778	0.549
33	15	1	0	1	1	0.894427180290222	-0.123572819709778	0.549
33	16	1	0	2	1.41421353816986	0.894427180290222	-0.123572819709778	0.549
34	14	1	1	0	0	0	-1.018	0.549
34	15	1	1	1	1	0	-1.018	0.549
34	16	1	1	2	1	0	-1.018	0.549
35	14	1	0	0	1	1.54919338226318	0.531193382263184	0.549
35	15	1	0	1	1	1.54919338226318	0.531193382263184	0.549
35	16	1	0	2	0	1.54919338226318	0.531193382263184	0.549
36	14	1	1	0	1	1.26491105556488	0.24691105556488	0.549
36	15	1	1	1	1	1.26491105556488	0.24691105556488	0.549
36	16	1	1	2	2	1.26491105556488	0.24691105556488	0.549
37	14	1	1	0	1	2	0.982	0.549
37	15	1	1	1	2.82842707633972	2	0.982	0.549
37	16	1	1	2	3.16227769851684	2	0.982	0.549
38	14	0	0	0	0	1.26491105556488	0.24691105556488	-0.451
38	15	0	0	1	1.73205077648162	1.26491105556488	0.24691105556488	-0.451
38	16	0	0	2	2	1.26491105556488	0.24691105556488	-0.451
39	14	0	1	0	0	0.894427180290222	-0.123572819709778	-0.451
39	15	0	1	1	0	0.894427180290222	-0.123572819709778	-0.451
39	16	0	1	2	0	0.894427180290222	-0.123572819709778	-0.451
40	14	0	0	0	0	2.52982211112976	1.51182211112976	-0.451
40	15	0	0	1	0	2.52982211112976	1.51182211112976	-0.451
40	16	0	0	2	0	2.52982211112976	1.51182211112976	-0.451
41	14	0	0	0	1.41421353816986	1.54919338226318	0.531193382263184	-0.451
41	15	0	0	1	0	1.54919338226318	0.531193382263184	-0.451
41	16	0	0	2	2	1.54919338226318	0.531193382263184	-0.451
42	14	0	0	0	0	0.894427180290222	-0.123572819709778	-0.451
42	15	0	0	1	0	0.894427180290222	-0.123572819709778	-0.451
42	16	0	0	2	0	0.894427180290222	-0.123572819709778	-0.451
43	14	0	0	0	0	0.894427180290222	-0.123572819709778	-0.451
43	15	0	0	1	0	0.894427180290222	-0.123572819709778	-0.451
43	16	0	0	2	0	0.894427180290222	-0.123572819709778	-0.451
44	14	0	1	0	0	0	-1.018	-0.451
44	15	0	1	1	1.41421353816986	0	-1.018	-0.451
44	16	0	1	2	3	0	-1.018	-0.451
45	14	0	0	0	2.2360680103302	1.78885436058044	0.770854360580444	-0.451
45	15	0	0	1	2.2360680103302	1.78885436058044	0.770854360580444	-0.451
45	16	0	0	2	3	1.78885436058044	0.770854360580444	-0.451
46	14	0	1	0	0	0.894427180290222	-0.123572819709778	-0.451
46	15	0	1	1	0	0.894427180290222	-0.123572819709778	-0.451
46	16	0	1	2	1.41421353816986	0.894427180290222	-0.123572819709778	-0.451
47	14	0	0	0	0	0.894427180290222	-0.123572819709778	-0.451
47	15	0	0	1	1	0.894427180290222	-0.123572819709778	-0.451
47	16	0	0	2	0	0.894427180290222	-0.123572819709778	-0.451
48	14	0	1	0	0	0	-1.018	-0.451
48	15	0	1	1	0	0	-1.018	-0.451
48	16	0	1	2	0	0	-1.018	-0.451
49	14	0	0	0	0	0	-1.018	-0.451
49	15	0	0	1	0	0	-1.018	-0.451
49	16	0	0	2	0	0	-1.018	-0.451
50	14	0	1	0	0	1.26491105556488	0.24691105556488	-0.451
50	15	0	1	1	0	1.26491105556488	0.24691105556488	-0.451
50	16	0	1	2	0	1.26491105556488	0.24691105556488	-0.451
51	14	0	1	0	0	0	-1.018	-0.451
51	15	0	1	1	0	0	-1.018	-0.451
51	16	0	1	2	0	0	-1.018	-0.451
52	14	0	0	0	0	0.894427180290222	-0.123572819709778	-0.451
52	15	0	0	1	1	0.894427180290222	-0.123572819709778	-0.451
52	16	0	0	2	0	0.894427180290222	-0.123572819709778	-0.451
53	14	0	1	0	0	0	-1.018	-0.451
53	15	0	1	1	0	0	-1.018	-0.451
53	16	0	1	2	0	0	-1.018	-0.451
54	14	0	0	0	0	0	-1.018	-0.451
54	15	0	0	1	0	0	-1.018	-0.451
54	16	0	0	2	1	0	-1.018	-0.451
55	14	0	1	0	0	1.54919338226318	0.531193382263184	-0.451
55	15	0	1	1	0	1.54919338226318	0.531193382263184	-0.451
55	16	0	1	2	0	1.54919338226318	0.531193382263184	-0.451
56	14	0	0	0	0	1.78885436058044	0.770854360580444	-0.451
56	15	0	0	1	1.41421353816986	1.78885436058044	0.770854360580444	-0.451
56	16	0	0	2	2.64575123786926	1.78885436058044	0.770854360580444	-0.451
57	14	0	1	0	0	0	-1.018	-0.451
57	15	0	1	1	0	0	-1.018	-0.451
57	16	0	1	2	0	0	-1.018	-0.451
58	14	0	1	0	1	0.894427180290222	-0.123572819709778	-0.451
58	15	0	1	1	1.41421353816986	0.894427180290222	-0.123572819709778	-0.451
58	16	0	1	2	2.44948983192443	0.894427180290222	-0.123572819709778	-0.451
59	14	0	1	0	0	0.894427180290222	-0.123572819709778	-0.451
59	15	0	1	1	0	0.894427180290222	-0.123572819709778	-0.451
59	16	0	1	2	2.64575123786926	0.894427180290222	-0.123572819709778	-0.451
60	14	0	0	0	0	0	-1.018	-0.451
60	15	0	0	1	1	0	-1.018	-0.451
60	16	0	0	2	1.41421353816986	0	-1.018	-0.451
61	14	0	0	0	2	2	0.982	-0.451
61	15	0	0	1	2.2360680103302	2	0.982	-0.451
61	16	0	0	2	2	2	0.982	-0.451
62	14	0	1	0	0	0.894427180290222	-0.123572819709778	-0.451
62	15	0	1	1	0	0.894427180290222	-0.123572819709778	-0.451
62	16	0	1	2	0	0.894427180290222	-0.123572819709778	-0.451
63	14	0	1	0	0	0	-1.018	-0.451
63	15	0	1	1	0	0	-1.018	-0.451
63	16	0	1	2	0	0	-1.018	-0.451
64	14	0	0	0	0	0.894427180290222	-0.123572819709778	-0.451
64	15	0	0	1	2	0.894427180290222	-0.123572819709778	-0.451
64	16	0	0	2	2.2360680103302	0.894427180290222	-0.123572819709778	-0.451
65	14	0	0	0	0	1.26491105556488	0.24691105556488	-0.451
65	15	0	0	1	1	1.26491105556488	0.24691105556488	-0.451
65	16	0	0	2	1.41421353816986	1.26491105556488	0.24691105556488	-0.451
66	14	0	1	0	1.41421353816986	1.26491105556488	0.24691105556488	-0.451
66	15	0	1	1	3.46410155296325	1.26491105556488	0.24691105556488	-0.451
66	16	0	1	2	3	1.26491105556488	0.24691105556488	-0.451
67	14	0	0	0	1	0.894427180290222	-0.123572819709778	-0.451
67	15	0	0	1	0	0.894427180290222	-0.123572819709778	-0.451
67	16	0	0	2	0	0.894427180290222	-0.123572819709778	-0.451
68	14	0	0	0	0	0	-1.018	-0.451
68	15	0	0	1	1	0	-1.018	-0.451
68	16	0	0	2	0	0	-1.018	-0.451
69	14	0	1	0	0	0.894427180290222	-0.123572819709778	-0.451
69	15	0	1	1	0	0.894427180290222	-0.123572819709778	-0.451
69	16	0	1	2	0	0.894427180290222	-0.123572819709778	-0.451
70	14	0	0	0	2	1.54919338226318	0.531193382263184	-0.451
70	15	0	0	1	1	1.54919338226318	0.531193382263184	-0.451
70	16	0	0	2	0	1.54919338226318	0.531193382263184	-0.451
71	14	0	1	0	0	0.894427180290222	-0.123572819709778	-0.451
71	15	0	1	1	0	0.894427180290222	-0.123572819709778	-0.451
71	16	0	1	2	0	0.894427180290222	-0.123572819709778	-0.451
72	14	0	0	0	0	0.894427180290222	-0.123572819709778	-0.451
72	15	0	0	1	0	0.894427180290222	-0.123572819709778	-0.451
72	16	0	0	2	0	0.894427180290222	-0.123572819709778	-0.451
73	14	0	1	0	0	0	-1.018	-0.451
73	15	0	1	1	0	0	-1.018	-0.451
73	16	0	1	2	0	0	-1.018	-0.451
74	14	0	1	0	0	1.54919338226318	0.531193382263184	-0.451
74	15	0	1	1	1.73205077648162	1.54919338226318	0.531193382263184	-0.451
74	16	0	1	2	2.2360680103302	1.54919338226318	0.531193382263184	-0.451
75	14	0	0	0	0	1.78885436058044	0.770854360580444	-0.451
75	15	0	0	1	0	1.78885436058044	0.770854360580444	-0.451
75	16	0	0	2	0	1.78885436058044	0.770854360580444	-0.451
76	14	0	0	0	0	0	-1.018	-0.451
76	15	0	0	1	0	0	-1.018	-0.451
76	16	0	0	2	0	0	-1.018	-0.451
77	14	0	1	0	0	0.894427180290222	-0.123572819709778	-0.451
77	15	0	1	1	1.41421353816986	0.894427180290222	-0.123572819709778	-0.451
77	16	0	1	2	2.82842707633972	0.894427180290222	-0.123572819709778	-0.451
78	14	0	0	0	0	0.894427180290222	-0.123572819709778	-0.451
78	15	0	0	1	0	0.894427180290222	-0.123572819709778	-0.451
78	16	0	0	2	0	0.894427180290222	-0.123572819709778	-0.451
79	14	0	1	0	1	0.894427180290222	-0.123572819709778	-0.451
79	15	0	1	1	2.2360680103302	0.894427180290222	-0.123572819709778	-0.451
79	16	0	1	2	1.41421353816986	0.894427180290222	-0.123572819709778	-0.451
80	14	0	1	0	1	0.894427180290222	-0.123572819709778	-0.451
80	15	0	1	1	1	0.894427180290222	-0.123572819709778	-0.451
80	16	0	1	2	1.73205077648162	0.894427180290222	-0.123572819709778	-0.451
81	14	0	1	0	0	1.54919338226318	0.531193382263184	-0.451
81	15	0	1	1	0	1.54919338226318	0.531193382263184	-0.451
81	16	0	1	2	0	1.54919338226318	0.531193382263184	-0.451
82	14	0	0	0	0	2.19089031219482	1.17289031219482	-0.451
82	15	0	0	1	1.41421353816986	2.19089031219482	1.17289031219482	-0.451
82	16	0	0	2	1	2.19089031219482	1.17289031219482	-0.451
;
run;

* Figure 4.1 p.77 | Identification de la forme adéquate de la trajectoire de changement;
title "Figure 4.1 'Identifying a suitable functional form'" ;
proc sgpanel data = alcoholpp (where = (id in (4, 14, 23, 32, 41, 56, 65, 82))) 
     noautolegend  ;
  panelby id / columns = 4 rows = 2;
  colaxis values = (13, 14, 15, 16, 17) ;
  rowaxis min = 0 max = 4;
  reg x = age y = alcuse;
run;



* Table 4.1 p.94-95 | Taxonomie d'une modélisation multiniveau du changement de la consommation d'alcool;
title1 "Table 4.1: Alcohol use data (alcohol1_pp): Fitted multilevel models for change" ;
proc mixed data=alcoholpp method=ml noclprint noinfo covtest;
  title2 "Model A" ;
  class id;
  model alcuse = /solution notest;
  random intercept/sub=id g; run;

proc mixed data=alcoholpp method=ml noclprint noinfo covtest;
  title2 "Model B" ;
  class id;
  model alcuse = age_14/solution notest;
  random intercept age_14/type=un sub=id g; run;

proc mixed data=alcoholpp method=ml noclprint noinfo covtest;
  title2 "Model C" ;
  class id;
  model alcuse = coa age_14 coa*age_14/solution notest;
  random intercept age_14/type=un sub=id g; run;

proc mixed data=alcoholpp method=ml noclprint noinfo covtest;
  title2 "Model D" ;
  class id;
  model alcuse = coa peer age_14 coa*age_14 peer*age_14 /solution notest;
  random intercept age_14/type=un sub=id g; run;

proc mixed data=alcoholpp method=ml noclprint noinfo covtest;
  title2 "Model E" ;
  class id;
  model alcuse = coa peer age_14 peer*age_14 /solution notest;
  random intercept age_14/type=un sub=id g; run;

proc mixed data=alcoholpp method=ml noclprint noinfo covtest;
  title2 "Model F" ;
  class id;
  model alcuse = coa cpeer age_14 cpeer*age_14 /solution notest;
  random intercept age_14/type=un sub=id g; run;

proc mixed data=alcoholpp method=ml noclprint noinfo covtest;
  title2 "Model G" ;
  class id;
  model alcuse = ccoa cpeer age_14 cpeer*age_14 /solution notest;
  random intercept age_14/type=un sub=id g;
run;



* Figure 4.4 p.130 | Graphique des valeurs prédites par unités de niveau 2;
proc sort data =alcoholpp out=fig4_4;
 by id;
run;
proc reg data = fig4_4 outest=est;
   by id;
  model alcuse = age_14;
run;
quit;
data fig4_4l;
  merge est(rename=(age_14=pred)) fig4_4;
  by id;
run;

ods output  PearsonCorr = corr;
proc corr data = fig4_4l nosimple noprob;
  var coa peer;
  with intercept pred;
run;



data _null_;
  set corr;
  if _n_ = 1 then do;
    call symput('int_coa',  put(coa, 4.2));
    call symput('int_peer', put(peer, 4.2));
  end;
  if _n_ = 2 then do;  
    call symput('pred_coa',  put(coa, 4.2));
    call symput('pred_peer', put(peer, 4.2));
  end;
run;

ods html style=journal2;
ods graphics on /width=3in height=3in border=off;
title;
proc sgplot data = fig4_4l;
 xaxis min = -.5 max = 1.5 values=(0,1) VALUESHINT;
 yaxis min = -1 max = 4 label="Intercept" ;
  scatter x = coa  y = intercept  /markerattrs = (symbol=circlefilled);
  refline 0 /axis=y;
  inset  "&int_coa" /noborder position=topright;
run;
proc sgplot data = fig4_4l;
 xaxis min = -.5 max = 1.5 values=(0,1) VALUESHINT;
 yaxis min = -1 max = 2 label="pred" ;
  scatter x = coa  y = pred  /markerattrs = (symbol=circlefilled);
  refline 0 /axis=y;
  inset  "&pred_coa" /noborder position=topright;
run;
proc sgplot data = fig4_4l;
 xaxis min = -.5 max = 3.5 values=(0,1,2,3) VALUESHINT;
 yaxis min = -1 max = 4 label="Intercept" ;
  scatter x = peer  y = intercept  /markerattrs = (symbol=circlefilled);
  refline 0 /axis=y;
  inset  "&int_peer" /noborder position=topright;
run;
proc sgplot data = fig4_4l ;
 xaxis min = -.5 max = 3.5 values=(0,1,2,3) VALUESHINT;
 yaxis min = -1 max = 2 label="pred" ;
  scatter x = peer  y = pred  /markerattrs = (symbol=circlefilled);
  refline 0 /axis=y;
  inset  "&pred_peer" /noborder position=topright;
run;




* Figure 4.5 p.131 | Graphiques des résidus standardisés de niveau 1 et 2;
proc template;
   define style MyStyleDefault;
   parent=Styles.journal2;
   style Graph from Graph /OutputWidth = 4in OutputHeight=3in ;
   style GraphWalls from GraphWalls /FrameBorder = off;
   end;
run;

ods html style=MystyleDefault;
proc mixed data=alcoholpp covtest method=ml;
  title2 "Model F" ;
  class id;
  model alcuse = coa cpeer age_14 cpeer*age_14 / outp=fig4_5 solution chisq ;
  random intercept age_14/type=un sub=id solution g;
  ods output SolutionR = fig4_5a;
run;


proc stdize data = fig4_5 out=fig4_5r;
  var resid;
run;
title;
proc sgplot data = fig4_5r;
  scatter x = id y = resid /markerattrs = (symbol=circlefilled);
  refline 0 /axis=y;
run;
quit;


proc stdize data = fig4_5a out=fig4_5rm (rename=(estimate = int));
 where effect = "Intercept" ;
  var estimate;
run;
proc sgplot data = fig4_5rm;
  format int 3.0;
  scatter x = id y = int /markerattrs = (symbol=circlefilled);
  refline 0 /axis=y;
run;


proc stdize data = fig4_5a out=fig4_5rm (rename=(estimate=age));
 where effect = "AGE_14" ;
  var estimate;
run;
proc sgplot data = fig4_5rm;
  format age 3.0;
  scatter x = id y= age /markerattrs = (symbol=circlefilled);
  refline 0 /axis=y;
run;
quit;




